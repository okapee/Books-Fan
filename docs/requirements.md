# Books Fan - 要件定義書

## 1. プロジェクト概要

本好きのための会員制レビュー・推薦プラットフォーム。AIを活用した本の要点整理・可視化機能を提供し、読者の嗜好に基づいたパーソナライズされた推薦を実現する。

## 2. ステークホルダー

- **無料ユーザー（非会員）**: 本のレビューや要点を閲覧できる
- **有料会員**: AIを活用した要点生成、カスタマイズ機能、レビュー投稿が可能
- **運営者**: コンテンツ管理、ユーザー管理、収益管理

## 3. 機能要件

### 3.1 認証・認可機能

#### ログイン・認証
- Google OAuth 2.0による認証（フェーズ1）
- 将来的な拡張: メールアドレス、その他のSNSアカウント

#### ユーザータイプ
1. **非会員（ゲスト）**
   - 全てのレビュー閲覧可能
   - AI生成された要点の閲覧可能（会員が生成したもの）
   - 本の詳細情報閲覧

2. **無料会員**
   - レビュー投稿（月5件まで）
   - お気に入り機能
   - 通知機能

3. **有料会員（プレミアム）**
   - 無制限のレビュー投稿
   - AI要点生成機能（月30冊まで）
   - AI要点の可視化（マインドマップ、チャート）
   - パーソナライズされた推薦
   - 詳細な読書統計
   - 広告非表示

### 3.2 本管理機能

#### 本の登録・検索
- Google Books API連携による書籍情報取得
- ISBN検索、タイトル検索、著者検索
- カバー画像、出版情報、あらすじの自動取得

#### 本の情報表示
- 基本情報（タイトル、著者、出版社、ISBN、ページ数）
- カバー画像
- あらすじ
- 平均評価
- レビュー一覧
- AI生成要点（会員が生成したもの）

### 3.3 レビュー機能

#### レビュー投稿
- 星評価（1-5）
- テキストレビュー
- ジャンルタグ付け
- 読書完了日
- 公開/非公開設定

#### レビュー表示
- 新着順、評価順、人気順でソート
- レビューへの「役に立った」ボタン
- コメント機能（フェーズ2）

### 3.4 AI機能（有料会員限定）

#### 本の要点生成
- ユーザーがレビューや読書ノートを入力
- AIが要点を箇条書きで整理
- キーポイントを3-5個抽出
- 要約文を生成（200-300文字）

#### 可視化機能
- マインドマップ形式での表示
- 関連性の可視化（テーマ、概念の繋がり）
- インタラクティブなチャート

#### AI使用制限
- 有料会員: 月30冊まで
- 使用回数の表示
- 制限超過時の案内

### 3.5 推薦・パーソナライゼーション機能

#### 読者カテゴリ分類
以下の軸でユーザーを自動分類：
1. **ジャンル嗜好**: 小説/ビジネス書/技術書/エッセイ/漫画 など
2. **読書スタイル**: 多読型/精読型/実用重視/娯楽重視
3. **興味領域**: キーワードベース（AI、歴史、心理学、SF など）

#### 推薦機能
- 「あなたへのおすすめ」: パーソナライズされた本の推薦
- 「この本を読んだ人におすすめ」: 協調フィルタリング
- カテゴリ別推薦: 同じ読者タイプの人に人気の本

#### 推薦理由の表示
- 「◯◯タイプの読者に人気」
- 「あなたの好きな△△系の本です」
- 「この本は□□について詳しく解説しています」

### 3.6 決済・課金機能

#### サブスクリプション管理
- Stripe連携
- プランタイプ:
  - **フリー**: ¥0/月
  - **プレミアム**: ¥980/月（年払い¥9,800で2ヶ月分お得）

#### 決済機能
- クレジットカード決済（Stripe）
- サブスクリプションの自動更新
- プラン変更・キャンセル
- 請求履歴の確認

### 3.7 ユーザープロフィール

- プロフィール画像
- 自己紹介
- 読者タイプバッジ表示
- 読書統計（読了冊数、レビュー数）
- お気に入りジャンル
- 公開レビュー一覧

### 3.8 検索・フィルタリング

- 本の検索（タイトル、著者、ISBN）
- ジャンルフィルター
- 評価フィルター
- 新着/人気のソート

### 3.9 通知機能

- フォローしているユーザーの新着レビュー
- 自分のレビューへの「役に立った」通知
- AI処理完了通知
- 課金関連の通知

## 4. 非機能要件

### 4.1 パフォーマンス
- ページ読み込み時間: 2秒以内
- AI要点生成: 30秒以内
- 同時接続ユーザー: 1,000人以上

### 4.2 セキュリティ
- OAuth 2.0による認証
- HTTPS通信の強制
- XSS、CSRF対策
- 個人情報の暗号化
- Stripe PCI DSS準拠

### 4.3 スケーラビリティ
- 水平スケーリング可能なアーキテクチャ
- データベースのスケーリング対応
- CDNによる静的コンテンツ配信

### 4.4 保守性
- TypeScriptによる型安全性
- コンポーネントベースの設計
- APIドキュメントの自動生成
- テストカバレッジ 70%以上

### 4.5 可用性
- 稼働率: 99.5%以上
- 自動バックアップ（日次）
- エラー監視・アラート

## 5. UI/UXデザイン要件

### 5.1 デザインコンセプト
- **コンセプト**: 「知的で洗練された、本への愛が伝わる空間」
- **カラースキーム**:
  - プライマリ: ディープブルー系（#1a365d）知性と信頼
  - セカンダリ: ウォームベージュ系（#f5f1e8）紙の温かみ
  - アクセント: ゴールド系（#d4af37）プレミアム感
- **タイポグラフィ**: 読みやすいセリフフォント（見出し）× サンセリフ（本文）

### 5.2 主要画面

#### トップページ
- ヒーローセクション: キャッチコピー + 検索バー
- 人気のレビュー（カード形式）
- カテゴリ別おすすめ
- 会員登録CTA

#### 本詳細ページ
- 大きなカバー画像
- 基本情報（グリッドレイアウト）
- 平均評価（星 + 数値）
- AI要点セクション（アコーディオン展開）
- レビュー一覧（無限スクロール）

#### AI要点可視化ページ
- インタラクティブなマインドマップ
- ズーム・パン機能
- ノードクリックで詳細表示
- エクスポート機能（PDF、画像）

#### ユーザーダッシュボード
- 読書統計（グラフ・チャート）
- 最近のアクティビティ
- おすすめ本（パーソナライズ）
- AI使用状況（プログレスバー）

#### レビュー投稿ページ
- ステップバイステップ形式
- リアルタイムプレビュー
- 下書き保存機能

### 5.3 レスポンシブデザイン
- モバイルファースト設計
- タブレット・デスクトップ対応
- ブレークポイント: 640px, 768px, 1024px, 1280px

### 5.4 アクセシビリティ
- WCAG 2.1 AA準拠
- キーボードナビゲーション
- スクリーンリーダー対応
- 適切なコントラスト比

## 6. データモデル

### 6.1 主要エンティティ

#### User（ユーザー）
- id
- googleId
- email
- displayName
- profileImage
- bio
- membershipType (FREE, PREMIUM)
- subscriptionId (Stripe)
- readerCategory
- createdAt
- updatedAt

#### Book（本）
- id
- isbn
- title
- author
- publisher
- publishedDate
- coverImageUrl
- description
- pageCount
- googleBooksId
- averageRating
- reviewCount
- createdAt
- updatedAt

#### Review（レビュー）
- id
- userId
- bookId
- rating (1-5)
- content
- isPublic
- readCompletedDate
- helpfulCount
- createdAt
- updatedAt

#### AISummary（AI要点）
- id
- userId
- bookId
- keyPoints (JSON配列)
- summaryText
- visualizationData (JSON)
- generatedAt
- isPublic

#### ReaderCategory（読者カテゴリ）
- id
- userId
- genrePreferences (JSON)
- readingStyle
- interestKeywords (配列)
- updatedAt

#### Subscription（サブスクリプション）
- id
- userId
- stripeCustomerId
- stripeSubscriptionId
- plan (FREE, PREMIUM)
- status (ACTIVE, CANCELED, PAST_DUE)
- currentPeriodEnd
- createdAt
- updatedAt

## 7. 外部サービス連携

### 7.1 Google Books API
- 書籍情報取得
- カバー画像取得

### 7.2 OpenAI API / Anthropic Claude API
- 本の要点生成
- 要約生成
- 推薦理由生成

### 7.3 Stripe
- サブスクリプション管理
- 決済処理
- Webhookによる更新通知

### 7.4 Google OAuth
- ユーザー認証

## 8. 開発フェーズ

### フェーズ1（MVP - 3ヶ月）
- Google認証
- 本の検索・登録
- レビュー投稿・閲覧
- 基本的なUI
- Stripe決済（プレミアムプラン）
- AI要点生成（基本）

### フェーズ2（4-6ヶ月）
- AI要点可視化
- 読者カテゴリ分類
- パーソナライズ推薦
- 通知機能
- コメント機能

### フェーズ3（7-9ヶ月）
- 高度な統計・分析
- ソーシャル機能（フォロー）
- モバイルアプリ検討
- 管理者ダッシュボード

## 9. 成功指標（KPI）

- 月間アクティブユーザー数（MAU）
- 有料会員転換率
- 平均レビュー投稿数/ユーザー
- AI機能利用率
- 解約率（Churn Rate）
- ユーザー満足度（NPS）

## 10. リスクと対策

### リスク1: AI API コスト高騰
- **対策**: 使用制限の適切な設定、キャッシング戦略、コスト監視アラート

### リスク2: 初期ユーザー獲得の困難
- **対策**: SEO最適化、コンテンツマーケティング、インフルエンサー協力

### リスク3: スケーリング時のパフォーマンス低下
- **対策**: 初期から水平スケーリング可能な設計、定期的な負荷テスト

### リスク4: コンテンツの質の担保
- **対策**: レビューガイドライン、不適切コンテンツの通報機能、モデレーション
